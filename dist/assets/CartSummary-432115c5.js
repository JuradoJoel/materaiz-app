var ae=Object.defineProperty;var le=(e,o,n)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n;var q=(e,o,n)=>(le(e,typeof o!="symbol"?o+"":o,n),n);import{y as T,j as t,i as F,aS as ie,aT as ce,_ as f,b as de,aU as pe,e as ue,f as ge,s as R,z as he,x as V,aV as G,aW as X,r as M,h as fe,I as ve,m as l,k as xe,l as me,ah as ye,U as h,T as a,aw as Ce,ax as Se,N as be,Z as H,aX as J,aY as k,aZ as B,$ as Q,a_ as we,X as Pe,J as Ae}from"./index-9953c07a.js";import{G as U,c as Ie,f as L,C as Y,b as D}from"./CartQuantityControl-23b0c5c1.js";import{T as $e}from"./TextField-b38cddfb.js";const Ee=T(t("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Me=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],ze=["component","slots","slotProps"],Oe=["component"];function K(e,o){const{className:n,elementType:r,ownerState:c,externalForwardedProps:b,getSlotOwnerState:d,internalForwardedProps:P}=o,m=F(o,Me),{component:y,slots:A={[e]:void 0},slotProps:p={[e]:void 0}}=b,z=F(b,ze),w=A[e]||r,C=ie(p[e],c),u=ce(f({className:n},m,{externalForwardedProps:e==="root"?z:void 0,externalSlotProps:C})),{props:{component:S},internalRef:O}=u,v=F(u.props,Oe),I=de(O,C==null?void 0:C.ref,o.ref),i=d?d(v):{},g=f({},c,i),$=e==="root"?S||y:S,x=pe(w,f({},e==="root"&&!y&&!A[e]&&P,e!=="root"&&!A[e]&&P,v,$&&{as:$},{ref:I}),g);return Object.keys(i).forEach(E=>{delete x[E]}),[w,x]}function We(e){return ge("MuiAlert",e)}const Le=ue("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),ee=Le,Te=T(t("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Fe=T(t("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Re=T(t("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Ne=T(t("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),je=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],_e=e=>{const{variant:o,color:n,severity:r,classes:c}=e,b={root:["root",`color${V(n||r)}`,`${o}${V(n||r)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return me(b,We,c)},ke=R(he,{name:"MuiAlert",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.root,o[n.variant],o[`${n.variant}${V(n.color||n.severity)}`]]}})(({theme:e})=>{const o=e.palette.mode==="light"?G:X,n=e.palette.mode==="light"?X:G;return f({},e.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${r}Color`]:o(e.palette[r].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${r}StandardBg`]:n(e.palette[r].light,.9),[`& .${ee.icon}`]:e.vars?{color:e.vars.palette.Alert[`${r}IconColor`]}:{color:e.palette[r].main}}})),...Object.entries(e.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${r}Color`]:o(e.palette[r].light,.6),border:`1px solid ${(e.vars||e).palette[r].light}`,[`& .${ee.icon}`]:e.vars?{color:e.vars.palette.Alert[`${r}IconColor`]}:{color:e.palette[r].main}}})),...Object.entries(e.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:f({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${r}FilledColor`],backgroundColor:e.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[r].dark:e.palette[r].main,color:e.palette.getContrastText(e.palette[r].main)})}))]})}),Be=R("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,o)=>o.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Ue=R("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,o)=>o.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),te=R("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,o)=>o.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),oe={success:t(Te,{fontSize:"inherit"}),warning:t(Fe,{fontSize:"inherit"}),error:t(Re,{fontSize:"inherit"}),info:t(Ne,{fontSize:"inherit"})},Ve=M.forwardRef(function(o,n){const r=fe({props:o,name:"MuiAlert"}),{action:c,children:b,className:d,closeText:P="Close",color:m,components:y={},componentsProps:A={},icon:p,iconMapping:z=oe,onClose:w,role:C="alert",severity:u="success",slotProps:S={},slots:O={},variant:v="standard"}=r,I=F(r,je),i=f({},r,{color:m,severity:u,variant:v,colorSeverity:m||u}),g=_e(i),$={slots:f({closeButton:y.CloseButton,closeIcon:y.CloseIcon},O),slotProps:f({},A,S)},[x,E]=K("closeButton",{elementType:ve,externalForwardedProps:$,ownerState:i}),[N,j]=K("closeIcon",{elementType:Ee,externalForwardedProps:$,ownerState:i});return l(ke,f({role:C,elevation:0,ownerState:i,className:xe(g.root,d),ref:n},I,{children:[p!==!1?t(Be,{ownerState:i,className:g.icon,children:p||z[u]||oe[u]}):null,t(Ue,{ownerState:i,className:g.message,children:b}),c!=null?t(te,{ownerState:i,className:g.action,children:c}):null,c==null&&w?t(te,{ownerState:i,className:g.action,children:t(x,f({size:"small","aria-label":P,title:P,color:"inherit",onClick:w},E,{children:t(N,f({fontSize:"small"},j))}))}):null]}))}),Ze=Ve,De=({item:e,compact:o=!1})=>{const{removeFromCart:n}=ye();return t(h,{sx:{px:o?1.5:0,py:o?.5:0},children:l(U,{container:!0,spacing:2,alignItems:"center",children:[t(U,{item:!0,xs:3,sm:2,md:1.5,lg:o?2.5:1.5,children:t("img",{src:e.product.images[0].image_url,alt:e.product.name,style:{width:"100%",maxWidth:80,maxHeight:80,aspectRatio:1,objectFit:"cover",borderRadius:10}})}),l(U,{item:!0,xs:9,sm:o?9.5:10,md:o?10:10.5,lg:o?9.5:10.5,children:[t(a,{variant:"body2",sx:{fontWeight:500,mb:1,textTransform:"none",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.product.name}),t(a,{color:"error",variant:"body2",sx:{cursor:"pointer",mb:1},onClick:()=>e.product.id&&n(e.product.id),children:"Eliminar"}),l(h,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t(h,{sx:{display:"flex",alignItems:"center",gap:1},children:t(Ie,{product:e.product,quantity:e.quantity,size:"small",sx:{bgcolor:"grey.200","&:hover":{bgcolor:"grey.300"}}})}),t(a,{variant:"h6",sx:{fontWeight:"bold"},children:L(e.product.discount_price??e.product.original_price)})]})]})]})})};class qe{constructor(){q(this,"calculate",async o=>{const{data:n}=await Se.post("/app/shipping/calculate",o);if(!n.success)throw new Error(n.message||"Error al calcular envío");return n.data.options})}}const Ge=new qe,Xe=()=>Ce({mutationFn:Ge.calculate,onSuccess:()=>{console.log("Costo de envío calculado correctamente")},onError:e=>{console.error("Error al calcular el costo de envío:",e)}});function Ke({cartProducts:e,totalAmount:o,totalWeight:n=.5,fromNav:r,onCheckout:c,showCheckoutForm:b,isHomeDelivery:d,onIsHomeDeliveryChange:P,onTotalChange:m,onResetCheckout:y}){var Z;const A=be(),[p,z]=M.useState(""),[w,C]=M.useState(!1),[u,S]=M.useState([]),[O,v]=M.useState(""),[I,i]=M.useState(""),g=Xe(),$=()=>{if(d&&p.trim()===""){C(!0);return}ne()},x=d&&((Z=u.find(s=>`${s.deliveryType}-${s.service}`===O))==null?void 0:Z.cost)||0,E=o+x;M.useEffect(()=>{m==null||m(E,x)},[E,x,m]);const N=s=>{P(s),y==null||y(),s||(z(""),C(!1),S([]),v(""),i(""),g.reset())},j=s=>{const W=s.target.value.replace(/\D/g,"").slice(0,8);z(W),C(!1),i(""),W.length===0&&(S([]),v(""))},re=()=>{if(p.length<4){i("El código postal debe tener al menos 4 dígitos");return}i(""),g.mutate({destCP:p,weight:n,dimensions:{length:20,width:15,height:10}},{onSuccess:s=>{if(S(s),s.length>0){const W=s[0];v(`${W.deliveryType}-${W.service}`)}},onError:()=>{i("No se pudo calcular el envío"),S([]),v("")}})},ne=()=>{r?A(Ae.cart.root):c==null||c()},_=g.isPending,se=g.isError;return e.length===0?t(Y,{sx:{position:"sticky",top:20},children:l(D,{children:[t(a,{variant:"h6",children:"Resumen de compra"}),t(a,{color:"text.secondary",sx:{mt:1},children:"No hay productos en el carrito."})]})}):t(Y,{sx:{position:"sticky",top:20},children:l(D,{children:[t(a,{variant:"h6",sx:{mb:2},children:"Resumen de compra"}),l(h,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[l(a,{children:["Productos (",e.length,")"]}),t(a,{children:L(o)})]}),t(H,{sx:{my:2}}),l(h,{sx:{mb:2},children:[t(a,{sx:{mb:1,fontWeight:500},children:"Método de entrega:"}),l(J,{name:"homeDelivery",value:d?"delivery":"freight",onChange:s=>N(s.target.value==="delivery"),children:[t(k,{value:"freight",control:t(B,{}),label:"Flete a coordinar con el vendedor"}),t(k,{value:"delivery",control:t(B,{}),label:"Envío a domicilio"})]})]}),d&&l(h,{sx:{mb:2,pl:4},children:[t(a,{sx:{mb:1,fontSize:"0.875rem",fontWeight:500},children:"Calculá tu envío:"}),l(h,{sx:{display:"flex",gap:1,mb:2},children:[t($e,{size:"small",placeholder:"Código Postal",value:p,onChange:j,inputProps:{maxLength:8},sx:{flex:1},required:d,error:w,helperText:w?"Ingresá un código postal válido":""}),t(Q,{variant:"outlined",onClick:re,disabled:_||p.length<4,sx:{minWidth:"100px"},children:_?t(we,{size:20}):"Calcular"})]}),(I||se)&&t(Ze,{severity:"error",sx:{mb:2},children:I||"Error al conectar con el servidor"}),u.length>0&&l(Pe,{children:[t(a,{sx:{mb:1,fontSize:"0.875rem",color:"text.secondary"},children:"Opciones de envío disponibles:"}),t(J,{value:O,onChange:s=>v(s.target.value),children:u.map(s=>t(k,{value:`${s.deliveryType}-${s.service}`,control:t(B,{}),label:l(h,{children:[t(a,{variant:"body2",children:s.service}),l(a,{variant:"caption",color:"text.secondary",children:[L(s.cost)," - Llega en ",s.estimatedDays," días"]})]})},`${s.deliveryType}-${s.service}`))})]}),u.length===0&&!_&&p.length>=4&&!I&&t(a,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"No hay opciones disponibles para este código postal"})]}),d?l(h,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t(a,{children:"Envío"}),t(a,{children:x>0?L(x):"—"})]}):l(h,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t(a,{children:"Envío"}),t(a,{color:"warning.main",sx:{fontWeight:500},children:"A coordinar"})]}),t(H,{sx:{my:2}}),l(h,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[t(a,{variant:"h6",children:"Total"}),t(a,{variant:"h6",sx:{fontWeight:"bold"},children:L(E)})]}),!b&&t(Q,{variant:"contained",color:"primary",fullWidth:!0,size:"large",onClick:$,disabled:d&&p.trim()==="",sx:{py:1.5,fontSize:"1rem",fontWeight:"bold"},children:"Continuar compra"})]})})}export{Ze as A,Ee as C,De as S,Ke as a,K as u};
